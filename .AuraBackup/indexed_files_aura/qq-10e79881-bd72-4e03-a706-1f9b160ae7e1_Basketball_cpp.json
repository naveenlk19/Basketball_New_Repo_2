{"file_path": "Source/BasketBallGame/Basketball.cpp", "file_id": "Source_BasketBallGame_Basketball_cpp", "asset_path": "", "doc_id": "qq-10e79881-bd72-4e03-a706-1f9b160ae7e1", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#include \"Basketball.h\"\n#include \"Components/StaticMeshComponent.h\"\n#include \"Components/SphereComponent.h\"\n#include \"Engine/StaticMesh.h\"\n\nABasketball::ABasketball()\n{\n\t// Set this actor to call Tick() every frame (not needed for prototype)\n\tPrimaryActorTick.bCanEverTick = false;\n\n\t// Create ball mesh component\n\tBallMesh = CreateDefaultSubobject<UStaticMeshComponent>(TEXT(\"BallMesh\"));\n\tRootComponent = BallMesh;\n\n\t// Setup ball physics\n\tBallMesh->SetSimulatePhysics(true);\n\tBallMesh->SetEnableGravity(true);\n\tBallMesh->SetCollisionEnabled(ECollisionEnabled::QueryAndPhysics);\n\tBallMesh->SetCollisionObjectType(ECollisionChannel::ECC_PhysicsBody);\n\tBallMesh->SetCollisionResponseToAllChannels(ECR_Block);\n\t\n\t// Set mass for basketball feel (approximately 0.62 kg in real life)\n\tBallMesh->SetMassOverrideInKg(NAME_None, 0.62f, true);\n\n\t// Create pickup detection sphere\n\tPickupRadius = CreateDefaultSubobject<USphereComponent>(TEXT(\"PickupRadius\"));\n\tPickupRadius->SetupAttachment(BallMesh);\n\tPickupRadius->InitSphereRadius(150.0f); // 1.5 meter pickup radius\n\tPickupRadius->SetCollisionEnabled(ECollisionEnabled::QueryOnly);\n\tPickupRadius->SetCollisionResponseToAllChannels(ECR_Ignore);\n\tPickupRadius->SetCollisionResponseToChannel(ECC_Pawn, ECR_Overlap);\n\n\t// Initialize state\n\tbIsHeld = false;\n\tBallOwner = nullptr;\n}\n\nvoid ABasketball::BeginPlay()\n{\n\tSuper::BeginPlay();\n\t\n\t// Ball starts on ground with physics enabled\n\tEnablePhysics();\n}\n\nvoid ABasketball::EnablePhysics()\n{\n\tif (BallMesh)\n\t{\n\t\tBallMesh->SetSimulatePhysics(true);\n\t\tBallMesh->SetEnableGravity(true);\n\t\tBallMesh->SetCollisionEnabled(ECollisionEnabled::QueryAndPhysics);\n\t}\n}\n\nvoid ABasketball::DisablePhysics()\n{\n\tif (BallMesh)\n\t{\n\t\tBallMesh->SetSimulatePhysics(false);\n\t\tBallMesh->SetEnableGravity(false);\n\t\tBallMesh->SetCollisionEnabled(ECollisionEnabled::NoCollision);\n\t}\n}\n\nvoid ABasketball::AttachToCharacter(AActor* Character, FName SocketName)\n{\n\tif (!Character)\n\t{\n\t\treturn;\n\t}\n\n\t// Disable physics while held\n\tDisablePhysics();\n\n\t// Attach to socket\n\tFAttachmentTransformRules AttachRules(\n\t\tEAttachmentRule::SnapToTarget,\n\t\tEAttachmentRule::SnapToTarget,\n\t\tEAttachmentRule::SnapToTarget,\n\t\tfalse\n\t);\n\n\tAttachToActor(Character, AttachRules, SocketName);\n\n\t// Update state\n\tbIsHeld = true;\n\tBallOwner = Character;\n}\n\nvoid ABasketball::DetachFromCharacter()\n{\n\t// Detach from parent\n\tFDetachmentTransformRules DetachRules(\n\t\tEDetachmentRule::KeepWorld,\n\t\tEDetachmentRule::KeepWorld,\n\t\tEDetachmentRule::KeepWorld,\n\t\tfalse\n\t);\n\n\tDetachFromActor(DetachRules);\n\n\t// Re-enable physics\n\tEnablePhysics();\n\n\t// Update state\n\tbIsHeld = false;\n\tBallOwner = nullptr;\n}\n"}