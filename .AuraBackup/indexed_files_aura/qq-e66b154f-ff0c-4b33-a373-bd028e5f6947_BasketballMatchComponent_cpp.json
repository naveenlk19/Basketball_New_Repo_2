{"file_path": "Source/BasketBallGame/BasketballMatchComponent.cpp", "file_id": "Source_BasketBallGame_BasketballMatchComponent_cpp", "asset_path": "", "doc_id": "qq-e66b154f-ff0c-4b33-a373-bd028e5f6947", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#include \"BasketballMatchComponent.h\"\n\nUBasketballMatchComponent::UBasketballMatchComponent()\n{\n\tPrimaryComponentTick.bCanEverTick = false;\n\n\t// Initialize stats\n\tResetStats();\n}\n\nvoid UBasketballMatchComponent::BeginPlay()\n{\n\tSuper::BeginPlay();\n\t\n\tUE_LOG(LogTemp, Log, TEXT(\"BasketballMatchComponent: Initialized\"));\n}\n\nvoid UBasketballMatchComponent::RegisterShotAttempt()\n{\n\t// Increment total attempts (ball was launched)\n\tTotalAttempts++;\n\t\n\tUE_LOG(LogTemp, Log, TEXT(\"BasketballMatchComponent: Shot attempt registered | TotalAttempts: %d\"), TotalAttempts);\n}\n\nvoid UBasketballMatchComponent::RegisterShotSuccess(int32 PointValue)\n{\n\t// Increment successful shots\n\tSuccessfulShots++;\n\t\n\t// Add points\n\tPoints += PointValue;\n\t\n\t// Update streak\n\tCurrentStreak++;\n\t\n\t// Update best streak\n\tif (CurrentStreak > BestStreak)\n\t{\n\t\tBestStreak = CurrentStreak;\n\t}\n\t\n\t// Update hot hand multiplier\n\t// Formula: 1.0 + (CurrentStreak * 0.05)\n\tHotHandMultiplier = 1.0f + (static_cast<float>(CurrentStreak) * 0.05f);\n\t\n\tUE_LOG(LogTemp, Log, TEXT(\"BasketballMatchComponent: Shot SUCCESS | Points: %d | Streak: %d | HotHand: %.2f | Efficiency: %.2f\"),\n\t\tPoints, CurrentStreak, HotHandMultiplier, CalculateEfficiency());\n\t\n}\n\nvoid UBasketballMatchComponent::RegisterShotMiss()\n{\n\t// Increment failed shots\n\tFailedShots++;\n\t\n\t// Reset streak\n\tCurrentStreak = 0;\n\t\n\t// Reset hot hand multiplier\n\tHotHandMultiplier = 1.0f;\n\t\n\tUE_LOG(LogTemp, Log, TEXT(\"BasketballMatchComponent: Shot MISS | Streak reset | Efficiency: %.2f\"), \n\t\tCalculateEfficiency());\n}\n\nfloat UBasketballMatchComponent::CalculateEfficiency() const\n{\n\tif (TotalAttempts == 0)\n\t{\n\t\treturn 0.0f;\n\t}\n\t\n\treturn static_cast<float>(SuccessfulShots) / static_cast<float>(TotalAttempts);\n}\n\nint32 UBasketballMatchComponent::CalculateXP() const\n{\n\tconst float Efficiency = CalculateEfficiency();\n\t\n\t// XP Formula (PROGRESSION ONLY - DERIVED, NOT STORED):\n\t// XP = (SuccessfulShots * 10) + (BestStreak * 5) + (Efficiency * 50)\n\t// \n\t// Validation Example:\n\t// SuccessfulShots=12, BestStreak=4, Efficiency=0.66\n\t// XP = (12*10) + (4*5) + (0.66*50) = 120 + 20 + 33 = 173\n\tconst int32 CalculatedXP = \n\t\t(SuccessfulShots * 10) \n\t\t+ (BestStreak * 5) \n\t\t+ FMath::RoundToInt(Efficiency * 50.0f);\n\t\n\treturn CalculatedXP;\n}\n\nint32 UBasketballMatchComponent::CalculateFinalScore() const\n{\n\tconst float Efficiency = CalculateEfficiency();\n\t\n\t// FinalScore Formula (COMPETITIVE ONLY - LEADERBOARD):\n\t// FinalScore = (Points * 10) + (Efficiency * 100) + (BestStreak * 5)\n\t// NOTE: Does NOT include XP or HotHandMultiplier\n\t// \n\t// Validation Example:\n\t// Points=24, Efficiency=0.66, BestStreak=4\n\t// FinalScore = (24*10) + (0.66*100) + (4*5) = 240 + 66 + 20 = 326\n\tconst int32 FinalScore = \n\t\t(Points * 10) \n\t\t+ FMath::RoundToInt(Efficiency * 100.0f) \n\t\t+ (BestStreak * 5);\n\t\n\treturn FinalScore;\n}\n\nvoid UBasketballMatchComponent::ResetStats()\n{\n\tSuccessfulShots = 0;\n\tFailedShots = 0;\n\tTotalAttempts = 0;\n\tPoints = 0;\n\tCurrentStreak = 0;\n\tBestStreak = 0;\n\tHotHandMultiplier = 1.0f;\n\t\n\tUE_LOG(LogTemp, Log, TEXT(\"BasketballMatchComponent: Stats reset\"));\n}\n"}