{"file_path": "Source/BasketBallGame/BasketballScoreManager.h", "file_id": "Source_BasketBallGame_BasketballScoreManager_h", "asset_path": "", "doc_id": "qq-21987bdc-3731-4b35-be09-27419374e9cb", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#pragma once\n\n#include \"CoreMinimal.h\"\n#include \"Components/ActorComponent.h\"\n#include \"BasketballScoreManager.generated.h\"\n\nclass ABasketBallHoop;\n\n/** Delegate for score changes */\nDECLARE_DYNAMIC_MULTICAST_DELEGATE_ThreeParams(FOnScoreChanged, int32, NewScore, int32, TotalMakes, int32, TotalAttempts);\n\n/** Delegate for timer updates */\nDECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam(FOnTimerUpdated, float, RemainingTime);\n\n/** Delegate for game state changes */\nDECLARE_DYNAMIC_MULTICAST_DELEGATE(FOnGameStarted);\nDECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam(FOnGameEnded, int32, FinalScore);\n\n/**\n * Manages basketball game scoring, timers, and statistics.\n * Attach to GameMode via CreateDefaultSubobject.\n * Automatically binds to all BasketballHoop actors in the level.\n */\nUCLASS(ClassGroup=(Custom), meta=(BlueprintSpawnableComponent))\nclass BASKETBALLGAME_API UBasketballScoreManager : public UActorComponent\n{\n\tGENERATED_BODY()\n\npublic:\n\tUBasketballScoreManager();\n\n\tvirtual void BeginPlay() override;\n\tvirtual void TickComponent(float DeltaTime, ELevelTick TickType, FActorComponentTickFunction* ThisTickFunction) override;\n\n\t// ======== Score Tracking ========\n\n\t/** Current total score */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Score\")\n\tint32 TotalScore;\n\n\t/** Total successful baskets */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Score\")\n\tint32 TotalMakes;\n\n\t/** Total shot attempts */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Score\")\n\tint32 TotalAttempts;\n\n\t/** Shooting percentage (0-100) */\n\tUFUNCTION(BlueprintPure, Category = \"Score\")\n\tfloat GetShootingPercentage() const;\n\n\t/** Consecutive makes streak */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Score\")\n\tint32 CurrentStreak;\n\n\t/** Best streak this session */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Score\")\n\tint32 BestStreak;\n\n\t// ======== Round Timer ========\n\n\t/** Total round duration in seconds (0 = no timer) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Timer\")\n\tfloat RoundDuration;\n\n\t/** Remaining time in current round */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Timer\")\n\tfloat RemainingTime;\n\n\t/** Is the game currently active? */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Timer\")\n\tbool bGameActive;\n\n\t// ======== Game Controls ========\n\n\t/** Start a new round */\n\tUFUNCTION(BlueprintCallable, Category = \"Game\")\n\tvoid StartGame();\n\n\t/** End the current round */\n\tUFUNCTION(BlueprintCallable, Category = \"Game\")\n\tvoid EndGame();\n\n\t/** Reset all scores and statistics */\n\tUFUNCTION(BlueprintCallable, Category = \"Game\")\n\tvoid ResetScore();\n\n\t/** Register a shot attempt (miss) */\n\tUFUNCTION(BlueprintCallable, Category = \"Score\")\n\tvoid RegisterAttempt();\n\n\t/** Add points to score (called by GameMode) */\n\tUFUNCTION(BlueprintCallable, Category = \"Score\")\n\tvoid AddScore(int32 Points);\n\n\t// ======== Events ========\n\n\t/** Called when score changes */\n\tUPROPERTY(BlueprintAssignable, Category = \"Events\")\n\tFOnScoreChanged OnScoreChanged;\n\n\t/** Called every second with remaining time */\n\tUPROPERTY(BlueprintAssignable, Category = \"Events\")\n\tFOnTimerUpdated OnTimerUpdated;\n\n\t/** Called when game starts */\n\tUPROPERTY(BlueprintAssignable, Category = \"Events\")\n\tFOnGameStarted OnGameStarted;\n\n\t/** Called when game ends */\n\tUPROPERTY(BlueprintAssignable, Category = \"Events\")\n\tFOnGameEnded OnGameEnded;\n\nprotected:\n\t/** Called when any hoop scores */\n\tUFUNCTION()\n\tvoid OnHoopScored(int32 Points);\n\n\t/** Find and bind to all hoops in the level */\n\tvoid BindToAllHoops();\n\n\t/** All hoops in the level */\n\tTArray<ABasketBallHoop*> RegisteredHoops;\n\n\t/** Timer tracking for broadcasting time updates */\n\tfloat LastBroadcastedTime;\n};\n"}