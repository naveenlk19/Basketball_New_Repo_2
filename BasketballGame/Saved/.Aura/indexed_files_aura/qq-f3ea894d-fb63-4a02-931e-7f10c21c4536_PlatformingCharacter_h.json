{"file_path": "Source/BasketBallGame/Variant_Platforming/PlatformingCharacter.h", "file_id": "Source_BasketBallGame_Variant_Platforming_PlatformingCharacter_h", "asset_path": "", "doc_id": "qq-f3ea894d-fb63-4a02-931e-7f10c21c4536", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#pragma once\n\n#include \"CoreMinimal.h\"\n#include \"GameFramework/Character.h\"\n#include \"Animation/AnimInstance.h\"\n#include \"PlatformingCharacter.generated.h\"\n\n\nclass USpringArmComponent;\nclass UCameraComponent;\nclass UInputAction;\nstruct FInputActionValue;\nclass UAnimMontage;\n\n/**\n *  An enhanced Third Person Character with the following functionality:\n *  - Platforming game character movement physics\n *  - Press and Hold Jump\n *  - Double Jump\n *  - Wall Jump\n *  - Dash\n */\nUCLASS(abstract)\nclass APlatformingCharacter : public ACharacter\n{\n\tGENERATED_BODY()\n\n\t/** Camera boom positioning the camera behind the character */\n\tUPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category=\"Components\", meta = (AllowPrivateAccess = \"true\"))\n\tUSpringArmComponent* CameraBoom;\n\n\t/** Follow camera */\n\tUPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category=\"Components\", meta = (AllowPrivateAccess = \"true\"))\n\tUCameraComponent* FollowCamera;\n\t\nprotected:\n\n\t/** Jump Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* JumpAction;\n\n\t/** Move Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* MoveAction;\n\n\t/** Look Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* LookAction;\n\n\t/** Mouse Look Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* MouseLookAction;\n\n\t/** Dash Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* DashAction;\n\npublic:\n\n\t/** Constructor */\n\tAPlatformingCharacter();\n\nprotected:\n\n\t/** Called for movement input */\n\tvoid Move(const FInputActionValue& Value);\n\n\t/** Called for looking input */\n\tvoid Look(const FInputActionValue& Value);\n\n\t/** Called for dash input */\n\tvoid Dash();\n\n\t/** Called for jump pressed to check for advanced multi-jump conditions */\n\tvoid MultiJump();\n\n\t/** Resets the wall jump input lock */\n\tvoid ResetWallJump();\n\npublic:\n\n\t/** Handles move inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoMove(float Right, float Forward);\n\n\t/** Handles look inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoLook(float Yaw, float Pitch);\n\n\t/** Handles dash inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoDash();\n\n\t/** Handles jump pressed inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoJumpStart();\n\n\t/** Handles jump pressed inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoJumpEnd();\n\nprotected:\n\n\t/** Called from a delegate when the dash montage ends */\n\tvoid DashMontageEnded(UAnimMontage* Montage, bool bInterrupted);\n\n\t/** Passes control to Blueprint to enable or disable jump trails */\n\tUFUNCTION(BlueprintImplementableEvent, Category=\"Platforming\")\n\tvoid SetJumpTrailState(bool bEnabled);\n\npublic:\n\n\t/** Ends the dash state */\n\tvoid EndDash();\n\npublic:\n\n\t/** Returns true if the character has just double jumped */\n\tUFUNCTION(BlueprintPure, Category=\"Platforming\")\n\tbool HasDoubleJumped() const;\n\n\t/** Returns true if the character has just wall jumped */\n\tUFUNCTION(BlueprintPure, Category=\"Platforming\")\n\tbool HasWallJumped() const;\n\npublic:\t\n\t\n\t/** EndPlay cleanup */\n\tvirtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;\n\n\t/** Sets up input action bindings */\n\tvirtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;\n\n\t/** Handle landings to reset dash and advanced jump state */\n\tvirtual void Landed(const FHitResult& Hit) override;\n\n\t/** Handle movement mode changes to keep track of coyote time jumps */\n\tvirtual void OnMovementModeChanged(EMovementMode PrevMovementMode, uint8 PreviousCustomMode = 0) override;\n\nprotected:\n\n\t/** movement state flag bits, packed into a uint8 for memory efficiency */\n\tuint8 bHasWallJumped : 1;\n\tuint8 bHasDoubleJumped : 1;\n\tuint8 bHasDashed : 1;\n\tuint8 bIsDashing : 1;\n\n\t/** timer for wall jump input reset */\n\tFTimerHandle WallJumpTimer;\n\n\t/** Dash montage ended delegate */\n\tFOnMontageEnded OnDashMontageEnded;\n\n\t/** Distance to trace ahead of the character to look for walls to jump from */\n\tUPROPERTY(EditAnywhere, Category=\"Wall Jump\", meta = (ClampMin = 0, ClampMax = 1000, Units = \"cm\"))\n\tfloat WallJumpTraceDistance = 50.0f;\n\n\t/** Radius of the wall jump sphere trace check */\n\tUPROPERTY(EditAnywhere, Category=\"Wall Jump\", meta = (ClampMin = 0, ClampMax = 100, Units = \"cm\"))\n\tfloat WallJumpTraceRadius = 25.0f;\n\n\t/** Impulse to apply away from the wall when wall jumping */\n\tUPROPERTY(EditAnywhere, Category=\"Wall Jump\", meta = (ClampMin = 0, ClampMax = 10000, Units = \"cm/s\"))\n\tfloat WallJumpBounceImpulse = 800.0f;\n\n\t/** Vertical impulse to apply when wall jumping */\n\tUPROPERTY(EditAnywhere, Category=\"Wall Jump\", meta = (ClampMin = 0, ClampMax = 10000, Units = \"cm/s\"))\n\tfloat WallJumpVerticalImpulse = 900.0f;\n\n\t/** Time to ignore jump inputs after a wall jump */\n\tUPROPERTY(EditAnywhere, Category=\"Wall Jump\", meta = (ClampMin = 0, ClampMax = 5, Units = \"s\"))\n\tfloat DelayBetweenWallJumps = 0.1f;\n\n\t/** AnimMontage to use for the Dash action */\n\tUPROPERTY(EditAnywhere, Category=\"Dash\")\n\tUAnimMontage* DashMontage;\n\n\t/** Last recorded time when this character started falling */\n\tfloat LastFallTime = 0.0f;\n\n\t/** Max amount of time that can pass since we started falling when we allow a regular jump */\n\tUPROPERTY(EditAnywhere, Category=\"Coyote Time\", meta = (ClampMin = 0, ClampMax = 5, Units = \"s\"))\n\tfloat MaxCoyoteTime = 0.16f;\n\npublic:\n\t/** Returns CameraBoom subobject **/\n\tFORCEINLINE class USpringArmComponent* GetCameraBoom() const { return CameraBoom; }\n\n\t/** Returns FollowCamera subobject **/\n\tFORCEINLINE class UCameraComponent* GetFollowCamera() const { return FollowCamera; }\n\n};\n"}