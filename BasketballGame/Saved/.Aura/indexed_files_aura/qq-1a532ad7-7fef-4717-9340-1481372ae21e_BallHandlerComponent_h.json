{"file_path": "Source/BasketBallGame/BallHandlerComponent.h", "file_id": "Source_BasketBallGame_BallHandlerComponent_h", "asset_path": "", "doc_id": "qq-1a532ad7-7fef-4717-9340-1481372ae21e", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#pragma once\n//#include \"BallHandlerComponent.h\"\n#include \"CoreMinimal.h\"\n#include \"Components/ActorComponent.h\"\n#include \"BallHandlerComponent.generated.h\"\n\nclass ABasketball;\nclass USplineMeshComponent;\nclass USplineComponent;\n\n/**\n * Component that manages basketball possession for a character\n * Handles picking up, holding, dropping, and shooting the ball\n * Includes trajectory preview while charging\n */\nUCLASS(ClassGroup=(Custom), meta=(BlueprintSpawnableComponent))\nclass BASKETBALLGAME_API UBallHandlerComponent : public UActorComponent\n{\n\tGENERATED_BODY()\n\npublic:\t\n\t/** Constructor */\n\tUBallHandlerComponent();\n\n\t/** Called when the game starts */\n\tvirtual void BeginPlay() override;\n\n\t/** Called every frame */\n\tvirtual void TickComponent(float DeltaTime, ELevelTick TickType, FActorComponentTickFunction* ThisTickFunction) override;\n\n\t// ======== Ball Handling ========\n\n\t/** Socket name where ball attaches (usually on hand) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Ball Handling\")\n\tFName BallSocketName;\n\n\t/** Maximum distance to detect balls for pickup */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Ball Handling\")\n\tfloat PickupRange;\n\n\t/** Reference to currently held ball (null if no ball) */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Ball Handling\")\n\tABasketball* CurrentBall;\n\n\t/** Is this character currently holding a ball? */\n\tUFUNCTION(BlueprintPure, Category = \"Ball Handling\")\n\tbool HasBall() const { return CurrentBall != nullptr; }\n\n\t/** Attempt to pick up nearby ball */\n\tUFUNCTION(BlueprintCallable, Category = \"Ball Handling\")\n\tbool TryPickupBall();\n\n\t/** Drop the currently held ball */\n\tUFUNCTION(BlueprintCallable, Category = \"Ball Handling\")\n\tvoid DropBall();\n\n\t/** Find nearest basketball within pickup range */\n\tUFUNCTION(BlueprintCallable, Category = \"Ball Handling\")\n\tABasketball* FindNearestBall();\n\n\t/** Manually set ball reference (useful for spawning with ball) */\n\tUFUNCTION(BlueprintCallable, Category = \"Ball Handling\")\n\tvoid SetBall(ABasketball* Ball);\n\n\t// ======== Shooting ========\n\n\t/** Maximum shot power (velocity in cm/s) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Shooting\")\n\tfloat MaxShotPower;\n\n\t/** Minimum shot power as fraction of max (0.0 to 1.0) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Shooting\", meta = (ClampMin = \"0.1\", ClampMax = \"0.9\"))\n\tfloat MinPowerFraction;\n\n\t/** Time to charge from min to max power (seconds) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Shooting\")\n\tfloat ChargeTime;\n\n\t/** Current shot charge (0.0 to 1.0) */\n\tUPROPERTY(BlueprintReadOnly, Category = \"Shooting\")\n\tfloat CurrentCharge;\n\n\t/** Arc angle at minimum charge (degrees) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Shooting\", meta = (ClampMin = \"20.0\", ClampMax = \"70.0\"))\n\tfloat MinArcAngle;\n\n\t/** Arc angle at maximum charge (degrees) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Shooting\", meta = (ClampMin = \"30.0\", ClampMax = \"80.0\"))\n\tfloat MaxArcAngle;\n\n\t/** Start charging shot (called on button press) */\n\tUFUNCTION(BlueprintCallable, Category = \"Shooting\")\n\tvoid StartCharging();\n\n\t/** Shoot ball with charged power (called on button release) */\n\tUFUNCTION(BlueprintCallable, Category = \"Shooting\")\n\tvoid ShootBall();\n\n\t/** Get current charge percentage (0-100) */\n\tUFUNCTION(BlueprintPure, Category = \"Shooting\")\n\tfloat GetChargePercent() const { return CurrentCharge * 100.0f; }\n\n\t/** Is currently charging a shot? */\n\tUFUNCTION(BlueprintPure, Category = \"Shooting\")\n\tbool IsCharging() const { return bIsCharging; }\n\n\t// ======== Trajectory Preview ========\n\n\t/** Number of points in the trajectory preview arc */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Trajectory Preview\")\n\tint32 TrajectoryPointCount;\n\n\t/** Time step between trajectory points (seconds of simulated flight) */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Trajectory Preview\")\n\tfloat TrajectoryTimeStep;\n\n\t/** Show trajectory preview while charging? */\n\tUPROPERTY(EditAnywhere, BlueprintReadWrite, Category = \"Trajectory Preview\")\n\tbool bShowTrajectory;\n\nprivate:\n\t/** Time when charging started */\n\tfloat ChargeStartTime;\n\n\t/** Is currently charging a shot? */\n\tbool bIsCharging;\n\n\t/** Calculate launch velocity based on current charge and aim */\n\tFVector CalculateLaunchVelocity() const;\n\n\t/** Calculate predicted trajectory points */\n\tTArray<FVector> CalculateTrajectoryPoints(const FVector& StartPos, const FVector& LaunchVelocity) const;\n\n\t/** Update the trajectory preview visualization */\n\tvoid UpdateTrajectoryPreview();\n\n\t/** Clear the trajectory preview */\n\tvoid ClearTrajectoryPreview();\n\n\t/** Debug draw trajectory points */\n\tTArray<FVector> CachedTrajectoryPoints;\n};\n"}