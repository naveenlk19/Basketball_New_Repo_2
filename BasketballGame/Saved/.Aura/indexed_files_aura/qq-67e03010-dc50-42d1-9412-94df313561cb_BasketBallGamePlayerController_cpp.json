{"file_path": "Source/BasketBallGame/BasketBallGamePlayerController.cpp", "file_id": "Source_BasketBallGame_BasketBallGamePlayerController_cpp", "asset_path": "", "doc_id": "qq-67e03010-dc50-42d1-9412-94df313561cb", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n\n#include \"BasketBallGamePlayerController.h\"\n#include \"EnhancedInputSubsystems.h\"\n#include \"Engine/LocalPlayer.h\"\n#include \"InputMappingContext.h\"\n#include \"Blueprint/UserWidget.h\"\n#include \"BasketBallGame.h\"\n#include \"Widgets/Input/SVirtualJoystick.h\"\n\nvoid ABasketBallGamePlayerController::BeginPlay()\n{\n\tSuper::BeginPlay();\n\n\t// only spawn touch controls on local player controllers\n\tif (SVirtualJoystick::ShouldDisplayTouchInterface() && IsLocalPlayerController())\n\t{\n\t\t// spawn the mobile controls widget\n\t\tMobileControlsWidget = CreateWidget<UUserWidget>(this, MobileControlsWidgetClass);\n\n\t\tif (MobileControlsWidget)\n\t\t{\n\t\t\t// add the controls to the player screen\n\t\t\tMobileControlsWidget->AddToPlayerScreen(0);\n\n\t\t} else {\n\n\t\t\tUE_LOG(LogBasketBallGame, Error, TEXT(\"Could not spawn mobile controls widget.\"));\n\n\t\t}\n\n\t}\n}\n\nvoid ABasketBallGamePlayerController::SetupInputComponent()\n{\n\tSuper::SetupInputComponent();\n\n\t// only add IMCs for local player controllers\n\tif (IsLocalPlayerController())\n\t{\n\t\t// Add Input Mapping Contexts\n\t\tif (UEnhancedInputLocalPlayerSubsystem* Subsystem = ULocalPlayer::GetSubsystem<UEnhancedInputLocalPlayerSubsystem>(GetLocalPlayer()))\n\t\t{\n\t\t\tfor (UInputMappingContext* CurrentContext : DefaultMappingContexts)\n\t\t\t{\n\t\t\t\tSubsystem->AddMappingContext(CurrentContext, 0);\n\t\t\t}\n\n\t\t\t// only add these IMCs if we're not using mobile touch input\n\t\t\tif (!SVirtualJoystick::ShouldDisplayTouchInterface())\n\t\t\t{\n\t\t\t\tfor (UInputMappingContext* CurrentContext : MobileExcludedMappingContexts)\n\t\t\t\t{\n\t\t\t\t\tSubsystem->AddMappingContext(CurrentContext, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"}