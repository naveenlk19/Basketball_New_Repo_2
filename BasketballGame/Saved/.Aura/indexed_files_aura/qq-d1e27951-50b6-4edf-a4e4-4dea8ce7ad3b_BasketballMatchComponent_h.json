{"file_path": "Source/BasketBallGame/BasketballMatchComponent.h", "file_id": "Source_BasketBallGame_BasketballMatchComponent_h", "asset_path": "", "doc_id": "qq-d1e27951-50b6-4edf-a4e4-4dea8ce7ad3b", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#pragma once\n\n#include \"CoreMinimal.h\"\n#include \"Components/ActorComponent.h\"\n#include \"BasketballMatchComponent.generated.h\"\n\n/**\n * Basketball Match Component\n * \n * Authority component for all match statistics and scoring logic.\n * Lives in GameMode. No replication, no UI references, no GameState references.\n * Pure gameplay logic only.\n * \n * Architecture:\n * - GameMode owns this component (authority)\n * - GameMode pushes snapshots to GameState (future replication)\n * - UI reads from GameState only\n * - XP is DERIVED (calculated on-demand), not stored\n * \n * Shot Flow (Two-Stage):\n * 1. BallHandler launches ball -> RegisterShotAttempt() -> TotalAttempts++\n * 2. Hoop detects outcome -> RegisterShotSuccess() OR RegisterShotMiss()\n */\nUCLASS(ClassGroup=(Custom), meta=(BlueprintSpawnableComponent))\nclass BASKETBALLGAME_API UBasketballMatchComponent : public UActorComponent\n{\n\tGENERATED_BODY()\n\npublic:\t\n\tUBasketballMatchComponent();\n\n\t// ======== Shot Registration (Authority) ========\n\t\n\t/** Register a shot attempt (ball launched) - called by GameMode when BallHandler shoots */\n\tvoid RegisterShotAttempt();\n\t\n\t/** Register a successful shot (ball scored) - called by GameMode when Hoop detects make */\n\tvoid RegisterShotSuccess(int32 PointValue);\n\t\n\t/** Register a shot miss (ball missed hoop) - called by GameMode when shot fails */\n\tvoid RegisterShotMiss();\n\n\t// ======== Calculation Functions (Const) ========\n\t\n\t/** Calculate current shooting efficiency (0.0 - 1.0) */\n\tUFUNCTION(BlueprintCallable, Category = \"Basketball|Match Stats\")\n\tfloat CalculateEfficiency() const;\n\t\n\t/** \n\t * Calculate total XP earned (progression metric, end of match only)\n\t * Formula: XP = (SuccessfulShots * 10) + (BestStreak * 5) + (Efficiency * 50)\n\t * NOTE: XP is DERIVED, not stored. Call this at match end and persist externally.\n\t */\n\tUFUNCTION(BlueprintCallable, Category = \"Basketball|Match Stats\")\n\tint32 CalculateXP() const;\n\t\n\t/** \n\t * Calculate final competitive score (leaderboard metric)\n\t * Formula: FinalScore = (Points * 10) + (Efficiency * 100) + (BestStreak * 5)\n\t * NOTE: Does NOT include XP or HotHandMultiplier\n\t */\n\tUFUNCTION(BlueprintCallable, Category = \"Basketball|Match Stats\")\n\tint32 CalculateFinalScore() const;\n\n\t// ======== Getters (Const, BlueprintPure) ========\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tint32 GetSuccessfulShots() const { return SuccessfulShots; }\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tint32 GetFailedShots() const { return FailedShots; }\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tint32 GetTotalAttempts() const { return TotalAttempts; }\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tint32 GetPoints() const { return Points; }\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tint32 GetCurrentStreak() const { return CurrentStreak; }\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tint32 GetBestStreak() const { return BestStreak; }\n\t\n\tUFUNCTION(BlueprintPure, Category = \"Basketball|Match Stats\")\n\tfloat GetHotHandMultiplier() const { return HotHandMultiplier; }\n\n\t// ======== Reset ========\n\t\n\t/** Reset all match statistics (called at match start) */\n\tUFUNCTION(BlueprintCallable, Category = \"Basketball|Match Stats\")\n\tvoid ResetStats();\n\nprotected:\n\tvirtual void BeginPlay() override;\n\nprivate:\n\t// ======== Core Statistics (Private, Authority Only) ========\n\t\n\t/** Total successful shots (makes) */\n\tint32 SuccessfulShots;\n\t\n\t/** Total failed shots (misses) */\n\tint32 FailedShots;\n\t\n\t/** Total shot attempts (incremented when ball is launched) */\n\tint32 TotalAttempts;\n\t\n\t/** Total points scored (SuccessfulShots * PointValue) */\n\tint32 Points;\n\t\n\t/** Current consecutive makes streak */\n\tint32 CurrentStreak;\n\t\n\t/** Best streak this match */\n\tint32 BestStreak;\n\t\n\t/** Hot hand multiplier (1.0 base + 0.05 per streak) */\n\tfloat HotHandMultiplier;\n\t\n\t// NOTE: XP is NOT stored here. It is derived via CalculateXP().\n};\n"}