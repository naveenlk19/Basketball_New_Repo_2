{"file_path": "Source/BasketBallGame/Variant_SideScrolling/SideScrollingCharacter.h", "file_id": "Source_BasketBallGame_Variant_SideScrolling_SideScrollingCharacter_h", "asset_path": "", "doc_id": "qq-26702a1b-2a68-47d1-916b-86bc910255d8", "referencers": [], "dependencies": [], "content": "// Copyright Epic Games, Inc. All Rights Reserved.\n\n#pragma once\n\n#include \"CoreMinimal.h\"\n#include \"GameFramework/Character.h\"\n#include \"SideScrollingCharacter.generated.h\"\n\nclass UCameraComponent;\nclass UInputAction;\nstruct FInputActionValue;\n\n/**\n *  A player-controllable character side scrolling game\n */\nUCLASS(abstract)\nclass ASideScrollingCharacter : public ACharacter\n{\n\tGENERATED_BODY()\n\n\t/** Player camera */\n\tUPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category =\"Camera\", meta = (AllowPrivateAccess = \"true\"))\n\tUCameraComponent* Camera;\n\nprotected:\n\n\t/** Move Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* MoveAction;\n\n\t/** Jump Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* JumpAction;\n\n\t/** Drop from Platform Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* DropAction;\n\n\t/** Interact Input Action */\n\tUPROPERTY(EditAnywhere, Category=\"Input\")\n\tUInputAction* InteractAction;\n\n\t/** Impulse to manually push physics objects while we're in midair */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Jump\")\n\tfloat JumpPushImpulse = 600.0f;\n\n\t/** Max distance that interactive objects can be triggered */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Interaction\")\n\tfloat InteractionRadius = 200.0f;\n\n\t/** Time to disable input after a wall jump to preserve momentum */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Wall Jump\")\n\tfloat DelayBetweenWallJumps = 0.3f;\n\n\t/** Distance to trace ahead of the character for wall jumps */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Wall Jump\")\n\tfloat WallJumpTraceDistance = 50.0f;\n\n\t/** Horizontal impulse to apply to the character during wall jumps */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Wall Jump\")\n\tfloat WallJumpHorizontalImpulse = 500.0f;\n\n\t/** Multiplies the jump Z velocity for wall jumps. */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Wall Jump\")\n\tfloat WallJumpVerticalMultiplier = 1.4f;\n\n\t/** Collision object type to use for soft collision traces (dropping down floors) */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Soft Platforms\")\n\tTEnumAsByte<ECollisionChannel> SoftCollisionObjectType;\n\n\t/** Distance to trace down during soft collision checks */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Soft Platforms\")\n\tfloat SoftCollisionTraceDistance = 1000.0f;\n\n\t/** Last recorded time when this character started falling */\n\tfloat LastFallTime = 0.0f;\n\n\t/** Max amount of time that can pass since we started falling when we allow a regular jump */\n\tUPROPERTY(EditAnywhere, Category=\"Side Scrolling|Coyote Time\", meta = (ClampMin = 0, ClampMax = 5, Units = \"s\"))\n\tfloat MaxCoyoteTime = 0.16f;\n\n\t/** Wall jump lockout timer */\n\tFTimerHandle WallJumpTimer;\n\n\t/** Last captured horizontal movement input value */\n\tfloat ActionValueY = 0.0f;\n\n\t/** Last captured platform drop axis value */\n\tfloat DropValue = 0.0f;\n\n\t/** If true, this character has already wall jumped */\n\tbool bHasWallJumped = false;\n\n\t/** If true, this character has already double jumped */\n\tbool bHasDoubleJumped = false;\n\n\t/** If true, this character is moving along the side scrolling axis */\n\tbool bMovingHorizontally = false;\n\npublic:\n\t\n\t/** Constructor */\n\tASideScrollingCharacter();\n\nprotected:\n\n\t/** Gameplay cleanup */\n\tvirtual void EndPlay(EEndPlayReason::Type EndPlayReason) override;\n\n\t/** Initialize input action bindings */\n\tvirtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;\n\n\t/** Collision handling */\n\tvirtual void NotifyHit(class UPrimitiveComponent* MyComp, AActor* Other, class UPrimitiveComponent* OtherComp, bool bSelfMoved, FVector HitLocation, FVector HitNormal, FVector NormalImpulse, const FHitResult& Hit) override;\n\n\t/** Landing handling */\n\tvirtual void Landed(const FHitResult& Hit) override;\n\n\t/** Handle movement mode changes to keep track of coyote time jumps */\n\tvirtual void OnMovementModeChanged(EMovementMode PrevMovementMode, uint8 PreviousCustomMode = 0) override;\n\nprotected:\n\n\t/** Called for movement input */\n\tvoid Move(const FInputActionValue& Value);\n\n\t/** Called for drop from platform input */\n\tvoid Drop(const FInputActionValue& Value);\n\n\t/** Called for drop from platform input release */\n\tvoid DropReleased(const FInputActionValue& Value);\n\npublic:\n\n\t/** Handles move inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoMove(float Forward);\n\n\t/** Handles drop inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoDrop(float Value);\n\n\t/** Handles jump pressed inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoJumpStart();\n\n\t/** Handles jump pressed inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoJumpEnd();\n\n\t/** Handles interact inputs from either controls or UI interfaces */\n\tUFUNCTION(BlueprintCallable, Category=\"Input\")\n\tvirtual void DoInteract();\n\nprotected:\n\n\t/** Handles advanced jump logic */\n\tvoid MultiJump();\n\n\t/** Checks for soft collision with platforms */\n\tvoid CheckForSoftCollision();\n\n\t/** Resets wall jump lockout. Called from timer after a wall jump */\n\tvoid ResetWallJump();\n\npublic:\n\n\t/** Sets the soft collision response. True passes, False blocks */\n\tvoid SetSoftCollision(bool bEnabled);\n\npublic:\n\n\t/** Returns true if the character has just double jumped */\n\tUFUNCTION(BlueprintPure, Category=\"Side Scrolling\")\n\tbool HasDoubleJumped() const;\n\n\t/** Returns true if the character has just wall jumped */\n\tUFUNCTION(BlueprintPure, Category=\"Side Scrolling\")\n\tbool HasWallJumped() const;\n};\n"}